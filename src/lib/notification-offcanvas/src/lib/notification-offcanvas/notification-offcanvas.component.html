<p-sidebar [(visible)]="sidebarVisible" position="right" (onHide)="onHide()">
  <ng-template pTemplate="header">
    <h6 class="font-bold text-base flex items-center">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-5 h-5 animate-wiggle animate-infinite animate-duration-[1000ms] animate-ease-linear animate-fill-both mr-1"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0M3.124 7.5A8.969 8.969 0 015.292 3m13.416 0a8.969 8.969 0 012.168 4.5"
        />
      </svg>
      Notifications

      <span
        class="py-1 px-1.5 inline-flex items-center gap-x-1 text-xs font-medium bg-red-100 text-red-800 rounded-full dark:bg-red-500/10 dark:text-red-500 ml-2"
      >
        <svg
          class="flex-shrink-0 w-3 h-3"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path
            d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"
          />
          <path d="M12 9v4" />
          <path d="M12 17h.01" />
        </svg>
        2 Unread
      </span>
    </h6>
  </ng-template>
  <ng-template pTemplate="content">
    <ng-container *ngIf="groupedNotifications">
      <section
        class="timeline-group mb-3"
        *ngFor="let group of getGroupedKeys(groupedNotifications)"
      >
        <h6 class="text-gray-400 font-semibold text-sm">
          {{ formatGroupDate(group) }}
        </h6>

        <ul *ngIf="groupedNotifications[group].length">
          <ng-container
            *ngFor="let notification of groupedNotifications[group]"
          >
            <ng-container [ngSwitch]="notification.activityType">
              <ng-container *ngSwitchCase="NotificationActivities.MENTION">
                <ng-container
                  *ngTemplateOutlet="
                    mentionNotificationTemplate;
                    context: { $implicit: notification }
                  "
                ></ng-container>
              </ng-container>
              <ng-container *ngSwitchCase="false"> </ng-container>
              <ng-container *ngSwitchDefault> </ng-container>
            </ng-container>
          </ng-container>
        </ul>
      </section>
    </ng-container>
  </ng-template>
  <ng-template pTemplate="footer">
    <a
      href=""
      class="text-sm text-primaryColor font-semibold flex items-center"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-4 h-4 mr-1"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0118 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3l1.5 1.5 3-3.75"
        />
      </svg>

      Mark all as read</a
    >
  </ng-template>
</p-sidebar>

<ng-template #commentNotificationTemplate let-notification="notification">
  <li class="mb-2">
    <div class="activity-item py-1 cursor-pointer">
      <div class="flex-shrink-0 group flex items-start justify-between w-full">
        <div class="flex items-center gap-x-2">
          <img
            class="inline-block flex-shrink-0 h-[2.2rem] w-[2.2rem] rounded-full"
            src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=facearea&facepad=2&w=300&h=300&q=80"
            alt="Image Description"
          />
          <div class="text-xs dark:text-dark-text">
            <span class="font-bold">mr.asdot</span> commented: Amazing
            interface.
            <span class="text-gray-300 dark:text-gray-500">1m</span>

            <div class="flex items-center italic space-x-3 text-gray-500 mt-1">
              <a href="">Reply</a>
              <a href="">Message</a>
            </div>
          </div>
        </div>

        <div class="w-[40%] text-right">
          <img
            class="w-full"
            src="assets/images/post-image.jpg"
            alt="Image Description"
          />
        </div>
      </div>
    </div>
  </li>
</ng-template>

<ng-template #mentionNotificationTemplate let-notification>
  <li class="mb-2">
    <div class="activity-item py-1 cursor-pointer">
      <div class="flex-shrink-0 group flex items-start justify-between w-full">
        <div class="flex items-center gap-x-2">
          <img
            class="inline-block flex-shrink-0 h-[2.2rem] w-[2.2rem] rounded-full"
            [src]="
              notification.source.imageUrl
                ? notification.source.imageUrl
                : 'assets/images/users/default.jpg'
            "
            [attr.alt]="notification.source.username"
          />
          <p class="text-xs dark:text-dark-text">
            <span [innerHTML]="sanitizeHtml(notification.message)"></span>
            <span class="text-gray-400 dark:text-gray-500 block">{{
              formateTime(notification.createdAt)
            }}</span>
          </p>
        </div>

        <div class="w-[40%] text-right" *ngIf="notification.target.targetImage">
          <img
            class="w-full"
            [src]="notification.target.targetImage"
            [attr.alt]="notification.target.targetContent"
          />
        </div>
      </div>
    </div>
  </li>
</ng-template>

<ng-template #followNotificationTemplate let-notification="notification">
  <li class="mb-2">
    <div class="activity-item py-1 cursor-pointer">
      <div class="flex-shrink-0 group flex items-start justify-between w-full">
        <div class="flex items-center gap-x-2">
          <img
            class="inline-block flex-shrink-0 h-[2.2rem] w-[2.2rem] rounded-full"
            src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=facearea&facepad=2&w=300&h=300&q=80"
            alt="Image Description"
          />
          <p class="text-xs dark:text-dark-text">
            <span class="font-bold">mr.asdot</span> started following you.
            <span class="text-gray-300 dark:text-gray-500">1m</span>
          </p>
        </div>

        <div class="w-[40%] text-right">
          <button
            type="button"
            class="bg-primaryColor text-white text-xs px-4 py-[0.4rem] rounded-full"
          >
            Follow back
          </button>
        </div>
      </div>
    </div>
  </li>
</ng-template>
